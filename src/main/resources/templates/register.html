<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta charset="UTF-8"/>
  <title>FoodTruckFinder</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

  <link href="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.js"></script>

  <link rel="stylesheet" th:href="@{/main.css}">
</head>
<body>

<div sec:authorize="isAuthenticated()">
	<nav th:replace="partials :: loggedNav"></nav>
</div>
<div sec:authorize="!isAuthenticated()">
	<nav th:replace="partials :: notLoggedNav"></nav>
</div>


<form th:action="@{/register}" method="post" th:object="${user}">
	<label for="username">Username</label>
	<input id="username" th:field="*{username}"/>
	
	<label for="email">Email</label>
	<input id="email" type="email" th:field="*{email}"/>
	
	<label for="password">Password</label>
	<input id="password" type="password" th:field="*{password}"/>
	
	<div>
		<input name="roleSelect" type="radio" value="user" id="userCheck" checked>
		<label class="form-check-label" for="userCheck">
			Consumer
		</label><br>
		<input name="roleSelect" type="radio" value="truck" id="truckCheck">
		<label class="form-check-label" for="truckCheck">
			Truck Owner
		</label>
	</div>
	
	<div id="avatar-choices">
		<label class="avatar"><img src="" alt=""><input th:field="*{profilePicture}" name="profilePicture" type="radio" value=""></label>
		<label class="avatar"><img src="" alt=""><input th:field="*{profilePicture}" name="profilePicture" type="radio" value=""></label>
		<label class="avatar"><img src="" alt=""><input th:field="*{profilePicture}" name="profilePicture" type="radio" value=""></label>
		<label class="avatar"><img src="" alt=""><input th:field="*{profilePicture}" name="profilePicture" type="radio" value=""></label>
		<label class="avatar"><img src="" alt=""><input th:field="*{profilePicture}" name="profilePicture" type="radio" value=""></label>
	</div>
	<input value="Sign me up!" type="submit"/>
</form>

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script>
	let avatars = Array.from(document.getElementsByClassName("avatar"));
	let fetchedPictures = [];
	$.ajax({
		url: "https://randomuser.me/api/?lego&results=" + 50,
		dataType: "json",
		cache: false,
		success: function (data) {
			data.results.forEach(result => {
				if(!fetchedPictures.includes(result.picture.thumbnail)) {
					fetchedPictures.push(result.picture.thumbnail);
				}
			});
			avatars.forEach((picture, index) => {
				picture.firstChild.src = fetchedPictures[index];
				picture.lastChild.value = fetchedPictures[index];
			});
		}
	});
</script>
<footer th:replace="partials :: footer"></footer>