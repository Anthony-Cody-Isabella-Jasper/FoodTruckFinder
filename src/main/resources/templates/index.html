<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
	<meta charset="UTF-8"/>
	<title>FoodTruckFinder</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.css" rel="stylesheet">
	<script src="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.js"></script>
	<link rel="stylesheet" th:href="@{/main.css}">
</head>
<body>
	
	<div sec:authorize="isAuthenticated()">
		<nav th:replace="partials :: loggedNav"></nav>
	</div>
	<div sec:authorize="!isAuthenticated()">
		<nav th:replace="partials :: notLoggedNav"></nav>
	</div>



	<div id="map"></div>
	<div class="input-group mb-3">
		<div class="input-group-prepend">
			<span class="input-group-text" id="truckSearch">Add magnifying glass icon</span>
		</div>
		<input type="text" class="form-control" placeholder="Search for FoodTruck" aria-label="Search" aria-describedby="truckSearch">
	</div>
	<div>
		<form th:action="@{/}" method="post">
			<label for="cuisineSelect">Cuisine</label>
			<select name="filterCuisine" id="cuisineSelect" class="custom-select">
				<option value="all" selected></option>
				<option value="all">all cuisines</option>
				<div th:each="cuisine : ${cuisines}">
					<option th:value="${cuisine.name}" th:text="${cuisine.name}"></option>
				</div>
			</select>
			<label for="veganCheck">Vegan</label>
			<input type="checkbox" id="veganCheck" name="vegan">
			<label for="vegetarianCheck">Vegetarian</label>
			<input type="checkbox" id="vegetarianCheck" name="vegetarian">
			<button type="submit">Apply Filters</button>
		</form>
		<form th:action="@{/}" method="get">
			<button type="submit">Clear Filters</button>
		</form>
	</div>
	<div class="row">
		<!--    "FOR EACH" FOR TRUCKS-->
		<div th:each="truck : ${trucks}" class="card">
			<!--        TRUCK IMAGE-->
			<img th:attr="src=${truck.profile_picture}" class="card-img-top" alt="...">
			<div class="card-body">
				<a th:href="@{/truck/{id}/show(id=${truck.id})}"><h5 class="truck-name">
					<span th:text="${truck.name}"></span></h5></a>
				<p class="truck-cuisine" th:each="cuisine : ${truck.cuisines}">Truck Cuisines:
					<span th:text="${cuisine.name}"></span></p>
				<a href="#" class="btn btn-primary">Truck location</a>
				<p>Average Rating: <span th:text="${truck.averageRating()}"></span></p>
			</div>
		</div>
	</div>
	<script>
		mapboxgl.accessToken = 'pk.eyJ1IjoiaG9kZ2VzY29keTAwIiwiYSI6ImNreXVtOG5odDFvc2EycHBlaHhpMzF1c3QifQ.6g0ZKujuRweI-lJkBKuWAQ';
		const map = new mapboxgl.Map({
			container: 'map', // container ID
			style: 'mapbox://styles/mapbox/streets-v11', // style URL
			center: [-74.5, 40], // starting position [lng, lat]
			zoom: 9 // starting zoom
		});
	</script>
	<footer th:replace="partials :: footer"></footer>